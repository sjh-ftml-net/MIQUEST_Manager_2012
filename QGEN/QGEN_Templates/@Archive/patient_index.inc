# -- Export patient indexes

# Export all patients (G file)
$QUERY, PAT_ALL_IXG, All opted patient list
FOR C_ALLPAT
SUBSET PAT_ALL_IXG TEMP
FROM PATIENTS
WHERE ACTIVE IN ("R","T","S","D","L","P")
$ENDQUERY

# Export all patients (R file)
$QUERY, PAT_ALL_IXR, All opted patient list
FOR PAT_ALL_IXG
REPORT
PRINT NHS_NUMBER,REFERENCE,SEX,DATE_OF_BIRTH,POSTCODE,GP_USUAL,REGISTERED_DATE,REMOVED_DATE,DATE_OF_DEATH,ACTIVE
FROM PATIENTS
WHERE ACTIVE IN ("R","T","S","D","L","P")
$ENDQUERY

# Export New patients (G file)
$QUERY, PAT_NEW_IXG, New opted patient list
FOR C_NEWPAT
SUBSET PAT_NEW_IXG TEMP
FROM PATIENTS
WHERE ACTIVE IN ("R","T","S","D","L","P")
$ENDQUERY

# Export New patients (R file)
$QUERY, PAT_NEW_IXR, New opted patient list
FOR PAT_NEW_IXG
REPORT
PRINT NHS_NUMBER,REFERENCE,SEX,DATE_OF_BIRTH,POSTCODE,GP_USUAL,REGISTERED_DATE,REMOVED_DATE,DATE_OF_DEATH,ACTIVE
FROM PATIENTS
WHERE ACTIVE IN ("R","T","S","D","L","P")
AND REGISTERED_DATE IN ("<delta_period_start>"-"<period_end>")
$ENDQUERY

# Lets try a more simple query based on the cohorts
$QUERY, Sim_PAT_NEW, Simple NEW PATIENTS
FOR C_NEWPAT
REPORT
PRINT NHS_NUMBER,REFERENCE,SEX,DATE_OF_BIRTH,POSTCODE,GP_USUAL,REGISTERED_DATE,REMOVED_DATE,DATE_OF_DEATH,ACTIVE
FROM PATIENTS
$ENDQUERY

# Lets try a more simple query based on the cohorts
$QUERY, Sim_PAT_ALL, Simple ALL PATIENTS
FOR C_ALLPAT
REPORT
PRINT NHS_NUMBER,REFERENCE,SEX,DATE_OF_BIRTH,POSTCODE,GP_USUAL,REGISTERED_DATE,REMOVED_DATE,DATE_OF_DEATH,ACTIVE
FROM PATIENTS
$ENDQUERY
